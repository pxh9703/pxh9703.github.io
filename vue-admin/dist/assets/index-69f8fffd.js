import{e as g,o as p,c as U,a as J,t as l,k as a,w as M,b as o,j as b,a8 as D,P as Q,a1 as d,F as T,V as S,a4 as x}from"./index-e107e4e2.js";import{E as W,a as X,b as Y,v as Z,c as q,d as ee,h as le,e as ae,f as te,g as oe,i as ne}from"./el-table-column-26b0dbe4.js";import{g as se}from"./el-button-d8ecbaf2.js";import{E as ue}from"./el-avatar-c4a58f90.js";import{u as de}from"./useUserApi-2a954765.js";const ie={class:"btn-group mb-2"},ve={__name:"index",setup(re){const f=de(),V=g("add"),c=g(!1),n=g({}),B={},u=g({list:[],total:0,page:1,pageSize:20,loadingTable:!1}),m=async()=>{u.value.loadingTable=!0;const{rows:s,count:t}=await f.getUserList({page:u.value.page,pageSize:u.value.pageSize});u.value.list=s,u.value.total=t,await Q(),u.value.loadingTable=!1};m();const F=s=>{u.value.pageSize=s,m()},R=s=>{u.value.page=s,m()},I=s=>{console.log(s)},L=s=>{c.value=!0,V.value="edit",n.value=s},$=s=>{f.deleteUser({id:s}).then(()=>{m()})},A=()=>{switch(n.value.password=123123123,V.value){case"add":f.createUser(n.value).then(()=>{m()});break;case"edit":f.updateUser(n.value).then(()=>{m()});break}c.value=!1},k=g([]),w=g(!1),C=(s="")=>{f.getRoleList({name:s}).then(t=>{k.value=t.rows})};C();const N=s=>{s?(w.value=!0,setTimeout(()=>{w.value=!1,C(s)},600)):C()};return(s,t)=>{const v=se,i=q,P=ue,h=ee,y=ne,z=le,j=W,K=X,E=ae,_=te,O=oe,G=Y,H=Z;return p(),U("div",null,[J("div",ie,[l(v,{size:"small",plain:"",onClick:t[0]||(t[0]=e=>[V.value="add",c.value=!0,n.value={}])},{default:a(()=>[d(" 添加用户 ")]),_:1})]),M((p(),b(j,{data:o(u).list,border:""},{default:a(()=>[l(i,{prop:"id",label:"ID",width:"80",align:"center"}),l(i,{prop:"account",label:"账号",width:"180",align:"center"}),l(i,{prop:"avatar",label:"头像",width:"120",align:"center"},{default:a(({row:e})=>[l(P,{src:e.avatar},null,8,["src"])]),_:1}),l(i,{prop:"email",label:"邮箱",width:"180",align:"center"},{default:a(({row:e})=>[d(T(e.email?e.email:"暂无邮箱"),1)]),_:1}),l(i,{prop:"introduction",label:"账号介绍",align:"center",width:"220","show-overflow-tooltip":""},{default:a(({row:e})=>[d(T(e.introduction?e.introduction:"暂无介绍"),1)]),_:1}),l(i,{prop:"status",label:"账号状态",width:"100",align:"center"},{default:a(({row:e})=>[e.status?(p(),b(h,{key:0,type:"success",onClick:r=>I(e.id)},{default:a(()=>[d("正常")]),_:2},1032,["onClick"])):(p(),b(h,{key:1,type:"danger"},{default:a(()=>[d("禁用")]),_:1}))]),_:1}),l(i,{prop:"role",label:"账号角色",width:"300",align:"center"},{default:a(({row:e})=>[l(z,{modelValue:e.role,"onUpdate:modelValue":r=>e.role=r,multiple:"","max-collapse-tags":2,"collapse-tags":"",class:"w-full",disabled:""},{default:a(()=>[(p(!0),U(S,null,x(o(k),r=>(p(),b(y,{key:r.id,label:r.name,value:r.roleKey,readonly:"",disabled:""},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),l(i,{label:"操作",fixed:"right",align:"center"},{default:a(({row:e})=>[l(v,{size:"small",onClick:r=>L(e)},{default:a(()=>[d("编辑")]),_:2},1032,["onClick"]),l(v,{size:"small",type:"danger",plain:"",onClick:r=>$(e.id)},{default:a(()=>[d("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[H,o(u).loadingTable]]),l(K,{"current-page":o(u).page,"page-sizes":[10,20,30,40],"page-size":o(u).pageSize,layout:"total, sizes, prev, pager, next, jumper",total:o(u).total,class:"mt-3 float-right",background:"",onSizeChange:F,onCurrentChange:R},null,8,["current-page","page-size","total"]),l(G,{modelValue:o(c),"onUpdate:modelValue":t[8]||(t[8]=e=>D(c)?c.value=e:null),title:o(V)=="add"?"添加用户":"编辑用户"},{footer:a(()=>[l(v,{onClick:t[7]||(t[7]=e=>c.value=!1)},{default:a(()=>[d("取消")]),_:1}),l(v,{type:"primary",onClick:A},{default:a(()=>[d("提交")]),_:1})]),default:a(()=>[l(O,{modelValue:o(n),"onUpdate:modelValue":t[6]||(t[6]=e=>D(n)?n.value=e:null),model:o(n),rules:B},{default:a(()=>[l(_,{label:"用户账号"},{default:a(()=>[l(E,{modelValue:o(n).account,"onUpdate:modelValue":t[1]||(t[1]=e=>o(n).account=e),placeholder:"请输入账号"},null,8,["modelValue"])]),_:1}),l(_,{label:"账号密码"},{default:a(()=>[l(E,{modelValue:o(n).password,"onUpdate:modelValue":t[2]||(t[2]=e=>o(n).password=e),"show-password":"",placeholder:"请输入账号密码"},null,8,["modelValue"])]),_:1}),l(_,{label:"账号角色"},{default:a(()=>[l(z,{modelValue:o(n).role,"onUpdate:modelValue":t[3]||(t[3]=e=>o(n).role=e),placeholder:"请选择账号角色",multiple:"",class:"w-full",filterable:"",remote:"","remote-method":N,loading:o(w),clearable:""},{default:a(()=>[(p(!0),U(S,null,x(o(k),e=>(p(),b(y,{key:e.id,label:e.name,value:e.roleKey},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1}),l(_,{label:"用户邮箱"},{default:a(()=>[l(E,{modelValue:o(n).email,"onUpdate:modelValue":t[4]||(t[4]=e=>o(n).email=e),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),l(_,{label:"账号介绍"},{default:a(()=>[l(E,{modelValue:o(n).introduction,"onUpdate:modelValue":t[5]||(t[5]=e=>o(n).introduction=e),placeholder:"请输入账号介绍"},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue","model"])]),_:1},8,["modelValue","title"])])}}};export{ve as default};
